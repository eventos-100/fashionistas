
seat_assignments
seating_sections



create table public.seat_assignments (
  id uuid not null default gen_random_uuid (),
  section_id uuid null,
  registration_id uuid null,
  row_number integer not null,
  seat_number integer not null,
  guest_name text null,
  guest_company text null,
  guest_title text null,
  vip_status text null,
  special_requirements text null,
  checked_in boolean null default false,
  checked_in_at timestamp with time zone null,
  assigned_at timestamp with time zone null default now(),
  assigned_by uuid null,
  organization_id uuid null,
  updated_at timestamp with time zone null default now(),
  constraint seat_assignments_pkey primary key (id),
  constraint seat_assignments_registration_id_key unique (registration_id),
  constraint seat_assignments_section_id_row_number_seat_number_key unique (section_id, row_number, seat_number),
  constraint seat_assignments_section_id_fkey foreign KEY (section_id) references seating_sections (id) on delete CASCADE,
  constraint seat_assignments_registration_id_fkey foreign KEY (registration_id) references registrations (id) on delete CASCADE,
  constraint seat_assignments_organization_id_fkey foreign KEY (organization_id) references organizations (id),
  constraint seat_assignments_assigned_by_fkey foreign KEY (assigned_by) references users (id)
) TABLESPACE pg_default;

create table public.seating_sections (
  id uuid not null default gen_random_uuid (),
  event_id uuid null,
  section_name text not null,
  section_code text not null,
  section_type text null,
  row_count integer not null default 1,
  seats_per_row integer not null,
  total_capacity integer GENERATED ALWAYS as ((row_count * seats_per_row)) STORED null,
  priority_level integer null default 0,
  pricing_multiplier numeric null default 1.0,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  organization_id uuid null,
  constraint seating_sections_pkey primary key (id),
  constraint seating_sections_event_id_section_code_key unique (event_id, section_code),
  constraint seating_sections_event_id_fkey foreign KEY (event_id) references events (id) on delete CASCADE,
  constraint seating_sections_organization_id_fkey foreign KEY (organization_id) references organizations (id),
  constraint seating_sections_section_type_check check (
    (
      section_type = any (
        array[
          'front_row'::text,
          'vip'::text,
          'press'::text,
          'buyers'::text,
          'influencers'::text,
          'general'::text
        ]
      )
    )
  )
) TABLESPACE pg_default;
