#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Update claude.md timestamp before commit
if [ -f "claude.md" ]; then
  # Update last updated timestamp
  if [[ "$OSTYPE" == "darwin"* ]]; then
    # macOS
    sed -i '' "s/\*\*Last Updated\*\*:.*/\*\*Last Updated\*\*: $(date -u +%Y-%m-%dT%H:%M:%SZ)/" claude.md
  else
    # Linux
    sed -i "s/\*\*Last Updated\*\*:.*/\*\*Last Updated\*\*: $(date -u +%Y-%m-%dT%H:%M:%SZ)/" claude.md
  fi
  
  # Stage the updated claude.md
  git add claude.md
fi

# Run other pre-commit checks
npm run lint
npm run type-check || true